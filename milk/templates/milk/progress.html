{% extends 'milk/base.html' %}

{% block content %}

<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.1.4/Chart.min.js"></script>



{% if progress.num == 100 %}
  <div>
    処理終了
    <script>


      function genData(){
          var size = getRandomInt( 20, 100 );
          var data = [];
          for( var i = 0; i < size; i++ ) {
              var x = getRandomInt( 0, 100 );
              var y = getRandomInt( 0, 100 );
              data.push( { x:x, y:y });
          }
          return data;
      };
    </script>
  </div>

  <div>
    <canvas id="accuracy"></canvas>
  </div>

  <div>
    <canvas id="roc"></canvas>
    <script>
      var ctx = document.getElementById('roc').getContext('2d');
      var roc = new Chart(ctx, {
        type: 'line',
        data: {
          labels: {{ false_positive_rate }},
          datasets: [{
            label: 'ROC',
            data: {{ true_positive_rate }},
            backgroundColor: "rgba(153,255,51,0.4)",
            borderColor: "rgba(153,255,51,0.4)",
            lineTension: 0
          }]
        }
      });
    </script>
  </div>


  <script>
    var ctx = document.getElementById('accuracy').getContext('2d');
    var accuracy = new Chart(ctx, {
      type: 'line',
      data: {
        labels: {{ epochs }},
        datasets: [{
          label: 'acc',
          data: {{ acc_list }},
          backgroundColor: "rgba(153,255,51,0.4)",
          borderColor: "rgba(153,255,51,0.4)",
          lineTension: 0
        }, {
          label: 'val_acc',
          data: {{ val_acc_list }},
          backgroundColor: "rgba(255,153,0,0.4)",
          borderColor: "rgba(255,153,0,0.4)",
          lineTension: 0
        }]
      }
    });
  </script>


{% else %}
<meta http-equiv="refresh" content="3">

  {% if progress.num > 0 %}
    <div>train_size: {{ progress.nb_train }}</div>

    <div class="progress">
      <div class="progress-bar progress-bar-striped progress-bar-animated" role="progressbar" aria-valuenow="{{ progress.num }}" aria-valuemin="0" aria-valuemax="100" style="width: {{ progress.num }}%"></div>
    </div>

    <canvas id="accuracy"></canvas>
    <script>
      var ctx = document.getElementById('accuracy').getContext('2d');
      var accuracy = new Chart(ctx, {
        type: 'line',
        data: {
          labels: {{ epochs }},
          datasets: [{
            label: 'acc',
            data: {{ acc_list }},
            backgroundColor: "rgba(153,255,51,0.4)",
            borderColor: "rgba(153,255,51,0.4)",
            lineTension: 0
          }, {
            label: 'val_acc',
            data: {{ val_acc_list }},
            backgroundColor: "rgba(255,153,0,0.4)",
            borderColor: "rgba(255,153,0,0.4)",
            lineTension: 0
          }]
        }
      });
    </script>

    <canvas id="roc"></canvas>
    <script>
      var ctx = document.getElementById('roc').getContext('2d');
      var roc = new Chart(ctx, {
        type: 'line',
        data: {
          labels: {{ false_positive_rate }},
          datasets: [{
            label: 'ROC',
            data: {{ true_positive_rate }},
            backgroundColor: "rgba(153,255,51,0.4)",
            borderColor: "rgba(153,255,51,0.4)",
            lineTension: 0
          }]
        }
      });
    </script>

    <canvas id="pca"></canvas>
    <script>
      var ctx = document.getElementById('pca').getContext('2d');
      var pca = new Chart(ctx, {
        type: 'line',
        data: {
          labels: {{ pca_x }},
          datasets: [{
            label: 'pca',
            data: {{ pca_y }},
            backgroundColor: "rgba(225,95,150, 1)",
            borderColor: "rgba(255,255,255,1)",
            lineTension: 0
          }]
        }
      });
    </script>


  {% else %}
    <div>データロード中...</div>
    {% load static %}
    <img src="{% static "milk/model.png" %}">

  {% endif %}

{% endif %}

{% endblock %}
